{"ast":null,"code":"import _objectSpread from\"C:/Users/Mega Store/Downloads/Shahen-website-main/front-end/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from\"react\";import{useNavigate}from\"react-router-dom\";import{useLanguage}from\"../contexts/language-context\";import{Button}from\"../components/ui/button\";import{Input}from\"../components/ui/input\";import{Label}from\"../components/ui/label\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const LoginPage=()=>{const{language,t}=useLanguage();const navigate=useNavigate();const[step,setStep]=useState(\"phone\");const[isLoading,setIsLoading]=useState(false);const[error,setError]=useState(\"\");const[phoneNumber,setPhoneNumber]=useState(\"\");const[otp,setOtp]=useState(\"\");const[formData,setFormData]=useState({companyName:\"\",email:\"\",taxNumber:\"\",city:\"\",postalCode:\"\",address:\"\",managerName:\"\"});const handlePhoneSubmit=async e=>{e.preventDefault();setError(\"\");setIsLoading(true);try{const response=await fetch(\"/api/auth/send-otp\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({phoneNumber})});const data=await response.json();if(!response.ok){throw new Error(data.message||t(\"otpSendError\"));}setStep(\"otp\");}catch(err){setError(err instanceof Error?err.message:t(\"otpSendError\"));}finally{setIsLoading(false);}};const handleOtpSubmit=async e=>{e.preventDefault();setError(\"\");setIsLoading(true);try{const response=await fetch(\"/api/auth/verify-otp\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({phoneNumber,otp})});const data=await response.json();if(!response.ok){throw new Error(data.message||t(\"otpVerifyError\"));}// Check if user needs to complete profile\nif(data.needsProfile){setStep(\"complete\");}else{// User already has profile, redirect to dashboard\nnavigate(\"/dashboard\");}}catch(err){setError(err instanceof Error?err.message:t(\"otpVerifyError\"));}finally{setIsLoading(false);}};const handleCompleteProfile=async e=>{e.preventDefault();setError(\"\");setIsLoading(true);try{const response=await fetch(\"/api/auth/complete-profile\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(_objectSpread({phoneNumber},formData))});const data=await response.json();if(!response.ok){throw new Error(data.message||t(\"profileCompleteError\"));}// Redirect to dashboard\nnavigate(\"/dashboard\");}catch(err){setError(err instanceof Error?err.message:t(\"profileCompleteError\"));}finally{setIsLoading(false);}};const handleChange=e=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[e.target.name]:e.target.value}));};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-gray-50 px-4 py-12\",dir:language===\"ar\"?\"rtl\":\"ltr\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-2xl\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-8 \".concat(language===\"ar\"?\"text-right\":\"text-left\"),children:/*#__PURE__*/_jsx(\"a\",{href:\"/\",className:\"inline-block\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-3xl font-bold text-emerald-600\",children:t(\"logo\")})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-lg p-8\",children:[step===\"phone\"&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900 mb-2\",children:t(\"loginTitle\")}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-6\",children:t(\"loginSubtitle\")}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handlePhoneSubmit,className:\"space-y-5\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"phoneNumber\",className:\"text-gray-700 font-medium\",children:t(\"phoneNumber\")}),/*#__PURE__*/_jsx(Input,{id:\"phoneNumber\",name:\"phoneNumber\",type:\"tel\",required:true,value:phoneNumber,onChange:e=>setPhoneNumber(e.target.value),placeholder:t(\"phoneNumberPlaceholder\"),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500\",disabled:isLoading})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm\",children:error}),/*#__PURE__*/_jsx(Button,{type:\"submit\",disabled:isLoading,className:\"w-full bg-emerald-600 hover:bg-emerald-700 text-white py-3 rounded-lg font-medium transition-all hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100\",children:isLoading?t(\"sending\"):t(\"sendOtp\")})]})]}),step===\"otp\"&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900 mb-2\",children:t(\"verifyOtp\")}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 mb-6\",children:[t(\"otpSentTo\"),\" \",phoneNumber]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleOtpSubmit,className:\"space-y-5\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"otp\",className:\"text-gray-700 font-medium\",children:t(\"otpCode\")}),/*#__PURE__*/_jsx(Input,{id:\"otp\",name:\"otp\",type:\"text\",required:true,value:otp,onChange:e=>setOtp(e.target.value),placeholder:t(\"otpPlaceholder\"),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 text-center text-2xl tracking-widest\",maxLength:6,disabled:isLoading})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm\",children:error}),/*#__PURE__*/_jsx(Button,{type:\"submit\",disabled:isLoading,className:\"w-full bg-emerald-600 hover:bg-emerald-700 text-white py-3 rounded-lg font-medium transition-all hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100\",children:isLoading?t(\"verifying\"):t(\"verifyButton\")}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setStep(\"phone\"),className:\"w-full text-emerald-600 hover:text-emerald-700 text-sm font-medium\",children:t(\"changePhone\")})]})]}),step===\"complete\"&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleCompleteProfile,className:\"space-y-8\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-900 mb-4\",children:t(\"companyInfo\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(Label,{htmlFor:\"companyName\",className:\"text-gray-700 font-medium\",children:[t(\"companyName\"),\" *\"]}),/*#__PURE__*/_jsx(Input,{id:\"companyName\",name:\"companyName\",type:\"text\",required:true,value:formData.companyName,onChange:handleChange,placeholder:t(\"companyNamePlaceholder\"),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500\",disabled:isLoading})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(Label,{htmlFor:\"email\",className:\"text-gray-700 font-medium\",children:[t(\"email\"),\" *\"]}),/*#__PURE__*/_jsx(Input,{id:\"email\",name:\"email\",type:\"email\",required:true,value:formData.email,onChange:handleChange,placeholder:t(\"emailPlaceholder\"),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500\",disabled:isLoading})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(Label,{htmlFor:\"taxNumber\",className:\"text-gray-700 font-medium\",children:[t(\"taxNumber\"),\" *\"]}),/*#__PURE__*/_jsx(Input,{id:\"taxNumber\",name:\"taxNumber\",type:\"text\",required:true,value:formData.taxNumber,onChange:handleChange,placeholder:t(\"taxNumberPlaceholder\"),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500\",disabled:isLoading})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(Label,{htmlFor:\"city\",className:\"text-gray-700 font-medium\",children:[t(\"city\"),\" *\"]}),/*#__PURE__*/_jsx(Input,{id:\"city\",name:\"city\",type:\"text\",required:true,value:formData.city,onChange:handleChange,placeholder:t(\"cityPlaceholder\"),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500\",disabled:isLoading})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(Label,{htmlFor:\"postalCode\",className:\"text-gray-700 font-medium\",children:[t(\"postalCode\"),\" *\"]}),/*#__PURE__*/_jsx(Input,{id:\"postalCode\",name:\"postalCode\",type:\"text\",required:true,value:formData.postalCode,onChange:handleChange,placeholder:t(\"postalCodePlaceholder\"),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500\",disabled:isLoading})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(Label,{htmlFor:\"address\",className:\"text-gray-700 font-medium\",children:[t(\"companyAddress\"),\" *\"]}),/*#__PURE__*/_jsx(Input,{id:\"address\",name:\"address\",type:\"text\",required:true,value:formData.address,onChange:handleChange,placeholder:t(\"companyAddressPlaceholder\"),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500\",disabled:isLoading})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-900 mb-4\",children:t(\"managerInfo\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(Label,{htmlFor:\"managerName\",className:\"text-gray-700 font-medium\",children:[t(\"managerName\"),\" *\"]}),/*#__PURE__*/_jsx(Input,{id:\"managerName\",name:\"managerName\",type:\"text\",required:true,value:formData.managerName,onChange:handleChange,placeholder:t(\"managerNamePlaceholder\"),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500\",disabled:isLoading})]})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm\",children:error}),/*#__PURE__*/_jsx(Button,{type:\"submit\",disabled:isLoading,className:\"w-full bg-emerald-600 hover:bg-emerald-700 text-white py-3 rounded-lg font-medium transition-all hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100\",children:isLoading?t(\"creating\"):t(\"createAccount\")})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6 text-center\",children:/*#__PURE__*/_jsxs(\"a\",{href:\"/\",className:\"text-gray-600 hover:text-gray-900 text-sm\",children:[language===\"ar\"?\"→\":\"←\",\" \",t(\"backToHome\")]})})]})});};export default LoginPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}